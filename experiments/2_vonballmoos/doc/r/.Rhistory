ggsave('../img/reduction_superox.png', width = 20, units = 'cm', dpi = 'print')
df_wide = read.csv("../data/raw/reduction_superox.csv")
df_full = gather(df_wide, series, absorption, wt_sol:neg_lipo)
df_full$series = factor(df_full$series)
df_full$protein[grepl('wt_', df_full$series, fixed=TRUE)] = 'wildtype'
df_full$protein[grepl('mut_', df_full$series, fixed=TRUE)] = 'mutant'
df_full$protein[grepl('neg_', df_full$series, fixed=TRUE)] = 'negative control'
df_full$state[grepl('_sol', df_full$series, fixed=TRUE)] = 'solubilized'
df_full$state[grepl('_lipo', df_full$series, fixed=TRUE)] = 'liposomes'
df_full$protein = factor(df_full$protein)
df_full$state = factor(df_full$state)
ggplot(df_full %>% filter(protein == 'mutant', state == 'liposomes'), aes(x = time, y = absorption, color = series)) +
geom_point(size = 0.1) +
geom_line() +
facet_wrap(vars(protein), ncol = 1) +
labs(title = "", x = "", y = "") +
theme_minimal() +
ggsave('../img/reduction_superox.png', width = 20, units = 'cm', dpi = 'print')
ggplot(df_full %>% filter(protein == 'mutant', state == 'solubilized'), aes(x = time, y = absorption, color = series)) +
geom_point(size = 0.1) +
geom_line() +
facet_wrap(vars(protein), ncol = 1) +
labs(title = "", x = "", y = "") +
theme_minimal() +
ggsave('../img/reduction_superox.png', width = 20, units = 'cm', dpi = 'print')
df_wide = read.csv("../data/raw/reduction_superox.csv")
df_full = gather(df_wide, series, absorption, wt_sol:neg_lipo)
df_full$series = factor(df_full$series)
df_full$protein[grepl('wt_', df_full$series, fixed=TRUE)] = 'wildtype'
df_full$protein[grepl('mut_', df_full$series, fixed=TRUE)] = 'mutant'
df_full$protein[grepl('neg_', df_full$series, fixed=TRUE)] = 'negative control'
df_full$state[grepl('_sol', df_full$series, fixed=TRUE)] = 'solubilized'
df_full$state[grepl('_lipo', df_full$series, fixed=TRUE)] = 'liposomes'
df_full$protein = factor(df_full$protein)
df_full$state = factor(df_full$state)
ggplot(df_full %>% filter(protein == 'mutant', state == 'solubilized'), aes(x = time, y = absorption, color = series)) +
geom_point(size = 0.1) +
geom_line() +
facet_wrap(vars(protein), ncol = 1) +
labs(title = "", x = "", y = "") +
theme_minimal() +
ggsave('../img/reduction_superox.png', width = 20, units = 'cm', dpi = 'print')
ggplot(df_full, aes(x = time, y = absorption, color = series)) +
geom_point(size = 0.1) +
geom_line() +
facet_wrap(vars(protein), ncol = 1) +
labs(title = "", x = "", y = "") +
theme_minimal() +
ggsave('../img/reduction_superox.png', width = 20, units = 'cm', dpi = 'print')
ggplot(df_full, aes(x = time, y = absorption, color = series)) +
geom_point(size = 0.1) +
geom_line() +
facet_wrap(vars(protein, state), ncol = 1) +
labs(title = "", x = "", y = "") +
theme_minimal() +
ggsave('../img/reduction_superox.png', width = 20, units = 'cm', dpi = 'print')
ggplot(df_full, aes(x = time, y = absorption, color = series)) +
geom_point(size = 0.1) +
geom_line() +
facet_wrap(vars(protein, state), ncol = 2) +
labs(title = "", x = "", y = "") +
theme_minimal() +
ggsave('../img/reduction_superox.png', width = 20, units = 'cm', dpi = 'print')
ggplot(df_full, aes(x = time, y = absorption, color = series)) +
geom_point(size = 0.1) +
geom_line() +
facet_wrap(vars(protein, state), ncol = 2) +
ylim(NA, 0.4) +
labs(title = "", x = "", y = "") +
theme_minimal() +
ggsave('../img/reduction_superox.png', width = 20, units = 'cm', dpi = 'print')
ggplot(df_full, aes(x = time, y = absorption, color = series)) +
geom_point(size = 0.1) +
geom_line() +
facet_wrap(vars(protein, state), ncol = 2) +
ylim(0, 0.4) +
labs(title = "", x = "", y = "") +
theme_minimal() +
ggsave('../img/reduction_superox.png', width = 20, units = 'cm', dpi = 'print')
ggplot(df_full, aes(x = time, y = absorption, color = series)) +
geom_point(size = 0.1) +
geom_line() +
facet_wrap(vars(protein, state), ncol = 2) +
ylim(NA, 0.4) +
labs(title = "", x = "", y = "") +
theme_minimal() +
ggsave('../img/reduction_superox.png', width = 20, units = 'cm', dpi = 'print')
ggplot(df_full, aes(x = time, y = absorption, color = series)) +
geom_point(size = 0.1) +
geom_line() +
facet_wrap(vars(protein, state), ncol = 2) +
coord_cartesian(ylim=c(NA, 0.4)) +
labs(title = "", x = "", y = "") +
theme_minimal() +
ggsave('../img/reduction_superox.png', width = 20, units = 'cm', dpi = 'print')
ggplot(df_full, aes(x = time, y = absorption, color = series)) +
geom_point(size = 0.1) +
geom_line() +
facet_wrap(vars(protein, state), ncol = 2) +
coord_cartesian(ylim=c(0, 0.4)) +
labs(title = "", x = "", y = "") +
theme_minimal() +
ggsave('../img/reduction_superox.png', width = 20, units = 'cm', dpi = 'print')
df_wide = read.csv("../data/raw/reduction_quinol.csv")
df_full = gather(df_wide, series, absorption, wt_sol:neg_lipo)
df_full$series = factor(df_full$series)
df_full$protein[grepl('wt_', df_full$series, fixed=TRUE)] = 'wildtype'
df_full$protein[grepl('mut_', df_full$series, fixed=TRUE)] = 'mutant'
df_full$protein[grepl('neg_', df_full$series, fixed=TRUE)] = 'negative control'
df_full$state[grepl('_sol', df_full$series, fixed=TRUE)] = 'solubilized'
df_full$state[grepl('_lipo', df_full$series, fixed=TRUE)] = 'liposomes'
df_full$protein = factor(df_full$protein)
df_full$state = factor(df_full$state)
absorption_base = df_full %>%
filter(protein %in% c('mutant', 'wildtype') & between(time, 0.8, 0.9)) %>%
group_by(protein, state) %>%
summarize(n_base = n(), max_absorption_base = max(absorption), min_absorption_base = min(absorption), avg_absorption_base = mean(absorption))
absorption_base
absorption_quinone = df_full %>%
filter(protein %in% c('mutant', 'wildtype') & between(time, 2.5, 2.6)) %>%
group_by(protein, state) %>%
summarize(n_quinone = n(), max_absorption_quinone = max(absorption), min_absorption_quinone = min(absorption), avg_absorption_quinone = mean(absorption))
absorption_quinone
absorption_reduced = df_full %>%
filter(protein %in% c('mutant', 'wildtype') & between(time, 3.9, 4)) %>%
group_by(protein, state) %>%
summarize(n_quinone = n(), max_absorption_reduced = max(absorption), min_absorption_reduced = min(absorption), avg_absorption_reduced = mean(absorption))
absorption_reduced
absorption = absorption_base %>%
left_join(absorption_quinone, by = c('protein', 'state')) %>%
left_join(absorption_reduced, by = c('protein', 'state')) %>%
select(protein, state, avg_absorption_base, avg_absorption_quinone, avg_absorption_reduced) %>%
mutate(relative_reduction = (avg_absorption_quinone - avg_absorption_base) / (avg_absorption_reduced - avg_absorption_base))
absorption
ggplot(df_full, aes(x = time, y = absorption, color = series)) +
geom_point(size = 0.1) +
geom_line() +
facet_wrap(vars(protein), ncol = 1) +
coord_cartesian(ylim=c(0, 0.4)) +
labs(title = "", x = "", y = "") +
theme_minimal() +
ggsave('../img/reduction_quinol.png', width = 20, units = 'cm', dpi = 'print')
ggplot(df_full, aes(x = time, y = absorption, color = series)) +
geom_point(size = 0.1) +
geom_line() +
facet_wrap(vars(protein), ncol = 1) +
coord_cartesian(ylim=c(0, 0.3)) +
labs(title = "", x = "", y = "") +
theme_minimal() +
ggsave('../img/reduction_quinol.png', width = 20, units = 'cm', dpi = 'print')
ggplot(df_full, aes(x = time, y = absorption, color = series)) +
geom_point(size = 0.1) +
geom_line() +
facet_wrap(vars(protein), ncol = 1) +
coord_cartesian(ylim=c(0, 0.35)) +
labs(title = "", x = "", y = "") +
theme_minimal() +
ggsave('../img/reduction_quinol.png', width = 20, units = 'cm', dpi = 'print')
ggplot(df_full, aes(x = time, y = absorption, color = series)) +
geom_point(size = 0.1) +
geom_line() +
facet_wrap(vars(protein), ncol = 1) +
coord_cartesian(ylim=c(0, 0.4)) +
labs(title = "", x = "", y = "") +
theme_minimal() +
ggsave('../img/reduction_quinol.png', width = 20, units = 'cm', dpi = 'print')
absorption
write.csv(absorption, '../data/reduction_quinol.csv', row.names = FALSE)
df_wide = read.csv("../data/raw/reduction_superox.csv")
df_full = gather(df_wide, series, absorption, wt_sol:neg_lipo)
df_full$series = factor(df_full$series)
df_full$protein[grepl('wt_', df_full$series, fixed=TRUE)] = 'wildtype'
df_full$protein[grepl('mut_', df_full$series, fixed=TRUE)] = 'mutant'
df_full$protein[grepl('neg_', df_full$series, fixed=TRUE)] = 'negative control'
df_full$state[grepl('_sol', df_full$series, fixed=TRUE)] = 'solubilized'
df_full$state[grepl('_lipo', df_full$series, fixed=TRUE)] = 'liposomes'
df_full$protein = factor(df_full$protein)
df_full$state = factor(df_full$state)
absorption_base = df_full %>%
filter(protein %in% c('mutant', 'wildtype') & between(time, 0.8, 0.9)) %>%
group_by(protein, state) %>%
summarize(n_base = n(), max_absorption_base = max(absorption), min_absorption_base = min(absorption), avg_absorption_base = mean(absorption))
absorption_base
absorption_quinone = df_full %>%
filter(protein %in% c('mutant', 'wildtype') & between(time, 2.5, 2.6)) %>%
group_by(protein, state) %>%
summarize(n_quinone = n(), max_absorption_quinone = max(absorption), min_absorption_quinone = min(absorption), avg_absorption_quinone = mean(absorption))
absorption_quinone
absorption_reduced = df_full %>%
filter(protein %in% c('mutant', 'wildtype') & between(time, 3.9, 4)) %>%
group_by(protein, state) %>%
summarize(n_quinone = n(), max_absorption_reduced = max(absorption), min_absorption_reduced = min(absorption), avg_absorption_reduced = mean(absorption))
absorption_reduced
absorption = absorption_base %>%
left_join(absorption_quinone, by = c('protein', 'state')) %>%
left_join(absorption_reduced, by = c('protein', 'state')) %>%
select(protein, state, avg_absorption_base, avg_absorption_quinone, avg_absorption_reduced) %>%
mutate(relative_reduction = (avg_absorption_quinone - avg_absorption_base) / (avg_absorption_reduced - avg_absorption_base))
absorption
ggplot(df_full, aes(x = time, y = absorption, color = series)) +
geom_point(size = 0.1) +
geom_line() +
facet_wrap(vars(protein, state), ncol = 2) +
coord_cartesian(ylim=c(0, 0.4)) +
labs(title = "", x = "", y = "") +
theme_minimal() +
ggsave('../img/reduction_superox.png', width = 20, units = 'cm', dpi = 'print')
absorption
df_full$addition[grepl('_sod', df_full$series, fixed=TRUE)] = 'SOD'
View(df_full)
df_full$addition = factor(df_full$addition)
df_full$addition = ifelse(grepl('_sod', df_full$series, fixed=TRUE), TRUE, FALSE)
df_full$addition = factor(df_full$addition)
absorption_base = df_full %>%
filter(protein %in% c('mutant', 'wildtype') & between(time, 0.8, 0.9)) %>%
group_by(protein, state, addition) %>%
summarize(n_base = n(), max_absorption_base = max(absorption), min_absorption_base = min(absorption), avg_absorption_base = mean(absorption))
absorption_base
df_full = gather(df_wide, series, absorption, wt_sol:neg_lipo)
df_full$series = factor(df_full$series)
df_full$protein[grepl('wt_', df_full$series, fixed=TRUE)] = 'wildtype'
df_full$protein[grepl('mut_', df_full$series, fixed=TRUE)] = 'mutant'
df_full$protein[grepl('neg_', df_full$series, fixed=TRUE)] = 'negative control'
df_full$state[grepl('_sol', df_full$series, fixed=TRUE)] = 'solubilized'
df_full$state[grepl('_lipo', df_full$series, fixed=TRUE)] = 'liposomes'
df_full$sod = ifelse(grepl('_sod', df_full$series, fixed=TRUE), TRUE, FALSE)
df_full$protein = factor(df_full$protein)
df_full$state = factor(df_full$state)
df_full$sod = factor(df_full$sod)
absorption_base = df_full %>%
filter(protein %in% c('mutant', 'wildtype') & between(time, 0.8, 0.9)) %>%
group_by(protein, state, addition) %>%
summarize(n_base = n(), max_absorption_base = max(absorption), min_absorption_base = min(absorption), avg_absorption_base = mean(absorption))
absorption_base = df_full %>%
filter(protein %in% c('mutant', 'wildtype') & between(time, 0.8, 0.9)) %>%
group_by(protein, state, sod) %>%
summarize(n_base = n(), max_absorption_base = max(absorption), min_absorption_base = min(absorption), avg_absorption_base = mean(absorption))
absorption_base
absorption_quinone = df_full %>%
filter(protein %in% c('mutant', 'wildtype') & between(time, 2.5, 2.6)) %>%
group_by(protein, state, sod) %>%
summarize(n_quinone = n(), max_absorption_quinone = max(absorption), min_absorption_quinone = min(absorption), avg_absorption_quinone = mean(absorption))
absorption_quinone
absorption_reduced = df_full %>%
filter(protein %in% c('mutant', 'wildtype') & between(time, 3.9, 4)) %>%
group_by(protein, state, sod) %>%
summarize(n_quinone = n(), max_absorption_reduced = max(absorption), min_absorption_reduced = min(absorption), avg_absorption_reduced = mean(absorption))
absorption_reduced
absorption = absorption_base %>%
left_join(absorption_quinone, by = c('protein', 'state', 'sod')) %>%
left_join(absorption_reduced, by = c('protein', 'state', 'sod')) %>%
select(protein, state, sod, avg_absorption_base, avg_absorption_quinone, avg_absorption_reduced) %>%
mutate(relative_reduction = (avg_absorption_quinone - avg_absorption_base) / (avg_absorption_reduced - avg_absorption_base))
absorption
write.csv(absorption, '../data/reduction_superox.csv', row.names = FALSE)
ggplot(df_full, aes(x = time, y = absorption, color = series)) +
geom_point(size = 0.1) +
geom_line() +
facet_wrap(vars(protein, state), ncol = 2) +
coord_cartesian(ylim=c(0, 0.4)) +
labs(title = "", x = "", y = "") +
theme_minimal() +
ggsave('../img/reduction_superox.png', width = 20, units = 'cm', dpi = 'print')
ggplot(df_full, aes(x = time, y = absorption, color = series)) +
geom_point(size = 0.1) +
geom_line() +
facet_wrap(vars(protein), ncol = 1) +
coord_cartesian(ylim=c(0, 0.4)) +
labs(title = "", x = "", y = "") +
theme_minimal() +
ggsave('../img/reduction_quinol.png', width = 20, units = 'cm', dpi = 'print')
df_wide = read.csv("../data/raw/reduction_quinol.csv")
df_full = gather(df_wide, series, absorption, wt_sol:neg_lipo)
df_full$series = factor(df_full$series)
df_full$protein[grepl('wt_', df_full$series, fixed=TRUE)] = 'wildtype'
df_full$protein[grepl('mut_', df_full$series, fixed=TRUE)] = 'mutant'
df_full$protein[grepl('neg_', df_full$series, fixed=TRUE)] = 'negative control'
df_full$state[grepl('_sol', df_full$series, fixed=TRUE)] = 'solubilized'
df_full$state[grepl('_lipo', df_full$series, fixed=TRUE)] = 'liposomes'
df_full$protein = factor(df_full$protein)
df_full$state = factor(df_full$state)
absorption_base = df_full %>%
filter(protein %in% c('mutant', 'wildtype') & between(time, 0.8, 0.9)) %>%
group_by(protein, state) %>%
summarize(n_base = n(), max_absorption_base = max(absorption), min_absorption_base = min(absorption), avg_absorption_base = mean(absorption))
absorption_base
absorption_quinone = df_full %>%
filter(protein %in% c('mutant', 'wildtype') & between(time, 2.5, 2.6)) %>%
group_by(protein, state) %>%
summarize(n_quinone = n(), max_absorption_quinone = max(absorption), min_absorption_quinone = min(absorption), avg_absorption_quinone = mean(absorption))
absorption_quinone
absorption_reduced = df_full %>%
filter(protein %in% c('mutant', 'wildtype') & between(time, 3.9, 4)) %>%
group_by(protein, state) %>%
summarize(n_quinone = n(), max_absorption_reduced = max(absorption), min_absorption_reduced = min(absorption), avg_absorption_reduced = mean(absorption))
absorption_reduced
absorption = absorption_base %>%
left_join(absorption_quinone, by = c('protein', 'state')) %>%
left_join(absorption_reduced, by = c('protein', 'state')) %>%
select(protein, state, avg_absorption_base, avg_absorption_quinone, avg_absorption_reduced) %>%
mutate(relative_reduction = (avg_absorption_quinone - avg_absorption_base) / (avg_absorption_reduced - avg_absorption_base))
absorption
write.csv(absorption, '../data/reduction_quinol.csv', row.names = FALSE)
ggplot(df_full, aes(x = time, y = absorption, color = series)) +
geom_point(size = 0.1) +
geom_line() +
facet_wrap(vars(protein), ncol = 1) +
coord_cartesian(ylim=c(0, 0.4)) +
labs(title = "Reduction of HS under ", x = "Time [min]", y = "Absorption at 428nm") +
theme_minimal() +
ggsave('../img/reduction_quinol.png', width = 20, units = 'cm', dpi = 'print')
ggplot(df_full, aes(x = time, y = absorption, color = series)) +
geom_point(size = 0.1) +
geom_line() +
facet_wrap(vars(protein), ncol = 1) +
coord_cartesian(ylim=c(0, 0.4)) +
labs(title = "Reduction of HS under quinone addition", x = "Time [min]", y = "Absorption at 428nm") +
theme_minimal() +
ggsave('../img/reduction_quinol.png', width = 20, units = 'cm', dpi = 'print')
ggplot(df_full, aes(x = time, y = absorption, color = series)) +
geom_point(size = 0.1) +
geom_line() +
facet_wrap(vars(protein), ncol = 1) +
coord_cartesian(ylim=c(0, 0.4)) +
labs(title = "Reduction of HS under quinone addition", x = "Time [min]", y = "Absorption at 428nm") +
theme_minimal() +
ggsave('../img/reduction_quinol.png', width = 20, units = 'cm', dpi = 'print')
df_wide = read.csv("../data/raw/reduction_superox.csv")
df_full = gather(df_wide, series, absorption, wt_sol:neg_lipo)
df_full$series = factor(df_full$series)
df_full$protein[grepl('wt_', df_full$series, fixed=TRUE)] = 'wildtype'
df_full$protein[grepl('mut_', df_full$series, fixed=TRUE)] = 'mutant'
df_full$protein[grepl('neg_', df_full$series, fixed=TRUE)] = 'negative control'
df_full$state[grepl('_sol', df_full$series, fixed=TRUE)] = 'solubilized'
df_full$state[grepl('_lipo', df_full$series, fixed=TRUE)] = 'liposomes'
df_full$sod = ifelse(grepl('_sod', df_full$series, fixed=TRUE), TRUE, FALSE)
df_full$protein = factor(df_full$protein)
df_full$state = factor(df_full$state)
df_full$sod = factor(df_full$sod)
absorption_base = df_full %>%
filter(protein %in% c('mutant', 'wildtype') & between(time, 0.8, 0.9)) %>%
group_by(protein, state, sod) %>%
summarize(n_base = n(), max_absorption_base = max(absorption), min_absorption_base = min(absorption), avg_absorption_base = mean(absorption))
absorption_base
absorption_quinone = df_full %>%
filter(protein %in% c('mutant', 'wildtype') & between(time, 2.5, 2.6)) %>%
group_by(protein, state, sod) %>%
summarize(n_quinone = n(), max_absorption_quinone = max(absorption), min_absorption_quinone = min(absorption), avg_absorption_quinone = mean(absorption))
absorption_quinone
absorption_reduced = df_full %>%
filter(protein %in% c('mutant', 'wildtype') & between(time, 3.9, 4)) %>%
group_by(protein, state, sod) %>%
summarize(n_quinone = n(), max_absorption_reduced = max(absorption), min_absorption_reduced = min(absorption), avg_absorption_reduced = mean(absorption))
absorption_reduced
absorption = absorption_base %>%
left_join(absorption_quinone, by = c('protein', 'state', 'sod')) %>%
left_join(absorption_reduced, by = c('protein', 'state', 'sod')) %>%
select(protein, state, sod, avg_absorption_base, avg_absorption_quinone, avg_absorption_reduced) %>%
mutate(relative_reduction = (avg_absorption_quinone - avg_absorption_base) / (avg_absorption_reduced - avg_absorption_base))
absorption
write.csv(absorption, '../data/reduction_superox.csv', row.names = FALSE)
ggplot(df_full, aes(x = time, y = absorption, color = series)) +
geom_point(size = 0.1) +
geom_line() +
facet_wrap(vars(protein, state), ncol = 2) +
coord_cartesian(ylim=c(0, 0.4)) +
labs(title = "Reduction of HS under superoxide addition", x = "Time [min]", y = "Absorption at 428nm") +
theme_minimal() +
ggsave('../img/reduction_superox.png', width = 20, units = 'cm', dpi = 'print')
library(ggplot2)
library(ggrepel)
library(dplyr)
library(scales)
library(tidyr)
library(viridis)
df_wide = read.csv("../data/raw/reduction_superox.csv")
df_full = gather(df_wide, series, absorption, wt_sol:neg_lipo)
df_full$series = factor(df_full$series)
df_full$protein[grepl('wt_', df_full$series, fixed=TRUE)] = 'wildtype'
df_full$protein[grepl('mut_', df_full$series, fixed=TRUE)] = 'mutant'
df_full$protein[grepl('neg_', df_full$series, fixed=TRUE)] = 'negative control'
df_full$state[grepl('_sol', df_full$series, fixed=TRUE)] = 'solubilized'
df_full$state[grepl('_lipo', df_full$series, fixed=TRUE)] = 'liposomes'
df_full$sod = ifelse(grepl('_sod', df_full$series, fixed=TRUE), TRUE, FALSE)
df_full$protein = factor(df_full$protein)
df_full$state = factor(df_full$state)
df_full$sod = factor(df_full$sod)
absorption_base = df_full %>%
filter(protein %in% c('mutant', 'wildtype') & between(time, 0.8, 0.9)) %>%
group_by(protein, state, sod) %>%
summarize(n_base = n(), max_absorption_base = max(absorption), min_absorption_base = min(absorption), avg_absorption_base = mean(absorption))
absorption_base
absorption_quinone = df_full %>%
filter(protein %in% c('mutant', 'wildtype') & between(time, 2.5, 2.6)) %>%
group_by(protein, state, sod) %>%
summarize(n_quinone = n(), max_absorption_quinone = max(absorption), min_absorption_quinone = min(absorption), avg_absorption_quinone = mean(absorption))
absorption_quinone
absorption_reduced = df_full %>%
filter(protein %in% c('mutant', 'wildtype') & between(time, 3.9, 4)) %>%
group_by(protein, state, sod) %>%
summarize(n_quinone = n(), max_absorption_reduced = max(absorption), min_absorption_reduced = min(absorption), avg_absorption_reduced = mean(absorption))
absorption_reduced
absorption = absorption_base %>%
left_join(absorption_quinone, by = c('protein', 'state', 'sod')) %>%
left_join(absorption_reduced, by = c('protein', 'state', 'sod')) %>%
select(protein, state, sod, avg_absorption_base, avg_absorption_quinone, avg_absorption_reduced) %>%
mutate(relative_reduction = (avg_absorption_quinone - avg_absorption_base) / (avg_absorption_reduced - avg_absorption_base))
absorption
write.csv(absorption, '../data/reduction_superox.csv', row.names = FALSE)
ggplot(df_full, aes(x = time, y = absorption, color = series)) +
geom_point(size = 0.1) +
geom_line() +
facet_wrap(vars(protein, state), ncol = 2) +
coord_cartesian(ylim=c(0, 0.4)) +
labs(title = "Reduction of HS under superoxide addition", x = "Time [min]", y = "Absorption at 428nm") +
theme_minimal() +
ggsave('../img/reduction_superox.png', width = 20, units = 'cm', dpi = 'print')
library(ggplot2)
library(ggrepel)
library(dplyr)
library(scales)
library(tidyr)
library(viridis)
df_wide_hs = read.csv("../data/raw/activity_mut_hs_conc.csv")
df_wide_hs = read.csv("../data/raw/activity_mut_hs_conc.csv")
df_full_hs = gather(df_wide_hs, series, absorption, has_0.5ul:hs_9ul)
df_full_hs = gather(df_wide_hs, series, absorption, hs_0.5ul:hs_9ul)
df_full_hs$series = factor(df_full_hs$series)
View(df_full_hs)
df_full_hs = gather(df_wide_hs, series, absorption, ref_x0:hs_9ul)
df_full_hs = gather(df_wide_hs, series, absorption, ref_xo:hs_9ul)
df_full_hs$series = factor(df_full_hs$series)
View(df_full_hs)
df_full$protein[grepl('ref_', df_full$series, fixed=TRUE)] = 'reference'
df_full$protein[grepl('hs_', df_full$series, fixed=TRUE)] = 'mutant'
df_full_hs$protein = factor(df_full$protein)
df_full_hs$state = factor(df_full$state)
df_full_hs$protein[grepl('ref_', df_full$series, fixed=TRUE)] = 'reference'
df_full_hs$protein[grepl('hs_', df_full$series, fixed=TRUE)] = 'mutant'
df_full_hs$protein = factor(df_full$protein)
df_full_hs$protein[grepl('ref_', df_full_hs$series, fixed=TRUE)] = 'reference'
df_full_hs$protein[grepl('hs_', df_full_hs$series, fixed=TRUE)] = 'mutant'
df_full_hs$protein = factor(df_full$protein)
df_full_hs$protein = factor(df_full_hs$protein)
ggplot(df_full, aes(x = time, y = absorption, color = series)) +
geom_point(size = 0.1) +
geom_line() +
facet_wrap(vars(protein), ncol = 1) +
coord_cartesian(ylim=c(0, 0.4)) +
labs(title = "Reduction of HS under superoxide addition", x = "Time [min]", y = "Absorption at 428nm") +
theme_minimal() +
ggsave('../img/activity_mut_hs', width = 20, units = 'cm', dpi = 'print')
ggplot(df_full_hs, aes(x = time, y = absorption, color = series)) +
geom_point(size = 0.1) +
geom_line() +
facet_wrap(vars(protein), ncol = 1) +
coord_cartesian(ylim=c(0, 0.4)) +
labs(title = "Reduction of HS under superoxide addition", x = "Time [min]", y = "Absorption at 428nm") +
theme_minimal() +
ggsave('../img/activity_mut_hs', width = 20, units = 'cm', dpi = 'print')
ggplot(df_full_hs, aes(x = time, y = absorption, color = series)) +
geom_point(size = 0.1) +
geom_line() +
facet_wrap(vars(protein), ncol = 1) +
coord_cartesian(ylim=c(0, 0.4)) +
labs(title = "", x = "Time [min]", y = "Absorption at ???nm") +
theme_minimal() +
ggsave('../img/activity_mut_hs', width = 20, units = 'cm', dpi = 'print')
ggplot(df_full_hs, aes(x = time, y = absorption, color = series)) +
geom_point(size = 0.1) +
geom_line() +
facet_wrap(vars(protein), ncol = 1) +
coord_cartesian(ylim=c(0, 0.4)) +
labs(title = "", x = "Time [min]", y = "Absorption at ???nm")
ggplot(df_full_hs, aes(x = time, y = absorption, color = series)) +
geom_point(size = 0.1) +
geom_line() +
coord_cartesian(ylim=c(0, 0.4)) +
labs(title = "", x = "Time [min]", y = "Absorption at ???nm")
ggplot(df_full_hs, aes(x = time, y = absorption, color = series)) +
geom_point(size = 0.1) +
geom_line() +
coord_cartesian(ylim=c(0, 0.4)) +
labs(title = "", x = "Time [min]", y = "Absorption at ???nm") +
theme_minimal() +
ggsave('../img/activity_mut_hs', width = 20, units = 'cm', dpi = 'print')
ggplot(df_full_hs, aes(x = time, y = absorption, color = series)) +
geom_point(size = 0.1) +
geom_line() +
labs(title = "", x = "Time [min]", y = "Absorption at ???nm") +
theme_minimal() +
ggsave('../img/activity_mut_hs', width = 20, units = 'cm', dpi = 'print')
ggplot(df_full_hs, aes(x = time, y = absorption, color = series)) +
geom_point(size = 0.1) +
geom_line() +
#coord_cartesian(ylim=c(0, 0.4)) +
labs(title = "", x = "Time [min]", y = "Absorption at ???nm") +
theme_minimal() #+
ggplot(df_full_hs, aes(x = time, y = absorption, color = series)) +
geom_point(size = 0.1) +
geom_line() +
#coord_cartesian(ylim=c(0, 0.4)) +
labs(title = "", x = "Time [min]", y = "Absorption at ???nm") +
theme_minimal() +
ggsave('../img/activity_mut_hs.png', width = 20, units = 'cm', dpi = 'print')
ggplot(df_full_hs, aes(x = time, y = absorption, color = series)) +
geom_point(size = 0.1) +
geom_line() +
#coord_cartesian(ylim=c(0, 0.4)) +
labs(title = "", x = "Time [min]", y = "Absorption at ???nm") +
theme_minimal() +
ggsave('../img/activity_mut_hs.png', width = 20, units = 'cm', dpi = 'print')
