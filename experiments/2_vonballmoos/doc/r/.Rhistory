df_full$state = factor(df_full$state)
df_full$protein = factor(df_full$protein)
baseline_correction = df_full %>%
filter(between(wavelength, 580, 600)) %>%
group_by(protein, state) %>%
summarize(n(), mean_absorption = mean(absorption)) %>%
group_by(protein) %>%
summarize(baseline_correction = max(mean_absorption) - min(mean_absorption))
baseline_correction
concentrations = df_full %>%
filter(between(wavelength, 561, 561.1)) %>%
group_by(protein) %>%
summarize(absorption_delta = max(absorption) - min(absorption)) %>%
left_join(baseline_correction, by="protein") %>%
mutate(absorption_delta_corrected = absorption_delta + baseline_correction) %>%
mutate(concentration = absorption_delta_corrected / extinction_factor * dilution_factor)
concentrations
write.csv(concentrations, '../data/hs_concentration.csv', row.names = FALSE)
ggplot(df_full, aes(x = wavelength, y = absorption, color = state)) +
geom_point(size = 0.1) +
geom_line() +
facet_wrap(vars(protein), ncol = 1) +
labs(title = "HS concentration determination", x = "Wavelength [nm]", y = "Absorption") +
theme_minimal() +
ggsave('../img/hs_concentration.png', width = 20, units = 'cm', dpi = 'print')
concentrations = df_full %>%
filter(between(wavelength, 561, 561.1)) %>%
group_by(protein) %>%
summarize(absorption_delta = max(absorption) - min(absorption)) %>%
left_join(baseline_correction, by="protein") %>%
mutate(absorption_delta_corrected = absorption_delta + baseline_correction) %>%
mutate(concentration = round(absorption_delta_corrected / extinction_factor * dilution_factor, 3))
concentrations
write.csv(concentrations, '../data/hs_concentration.csv', row.names = FALSE)
concentrations
round(concentrations, 3)
concentrations = df_full %>%
filter(between(wavelength, 561, 561.1)) %>%
group_by(protein) %>%
summarize(absorption_delta = round(max(absorption) - min(absorption), 3)) %>%
left_join(baseline_correction, by="protein") %>%
mutate(absorption_delta_corrected = round(absorption_delta + baseline_correction, 3)) %>%
mutate(concentration = round(absorption_delta_corrected / extinction_factor * dilution_factor, 3))
concentrations = df_full %>%
filter(between(wavelength, 561, 561.1)) %>%
group_by(protein) %>%
summarize(absorption_delta = round(max(absorption) - min(absorption), 3)) %>%
left_join(baseline_correction, by="protein") %>%
mutate(absorption_delta_corrected = round(absorption_delta + baseline_correction, 3)) %>%
mutate(concentration = round(absorption_delta_corrected / extinction_factor * dilution_factor, 3))
concentrations
write.csv(concentrations, '../data/hs_concentration.csv', row.names = FALSE)
baseline_correction = df_full %>%
filter(between(wavelength, 580, 600)) %>%
group_by(protein, state) %>%
summarize(n(), mean_absorption = mean(absorption)) %>%
group_by(protein) %>%
summarize(baseline_correction = round(max(mean_absorption) - min(mean_absorption), 3))
baseline_correction
concentrations = df_full %>%
filter(between(wavelength, 561, 561.1)) %>%
group_by(protein) %>%
summarize(absorption_delta = round(max(absorption) - min(absorption), 3)) %>%
left_join(baseline_correction, by="protein") %>%
mutate(absorption_delta_corrected = round(absorption_delta + baseline_correction, 3)) %>%
mutate(concentration = round(absorption_delta_corrected / extinction_factor * dilution_factor, 3))
concentrations
write.csv(concentrations, '../data/hs_concentration.csv', row.names = FALSE)
write.csv(concentrations, '../data/hs_concentration.csv', row.names = FALSE, quote=FALSE)
df = read.csv("../data/raw/purification_fluorescence.csv")
# 15 ul, sample volumes in file in ml
measurement_volume = 15 / 1000
df$fluorescence_sample = df$fluorescence / measurement_volume * df$sample_volume
ggplot(df, aes(x = reorder(sample, measurement), y = fluorescence_sample, fill = stage)) +
geom_col() +
labs(title = "Fluorescence measuremens during purification", x = "Sample", y = "Flourescence (586nm emission, 555nm extinction") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90), legend.position = "none") +
ggsave('../img/purification_fluorescence.png', width = 20, units = 'cm', dpi = 'print')
ggplot(df, aes(x = reorder(sample, measurement), y = fluorescence_sample, fill = stage)) +
geom_col() +
labs(title = "Fluorescence measuremens during purification", x = "Sample", y = "Flourescence (586nm emission, 555nm extinction") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90)) +
ggsave('../img/purification_fluorescence.png', width = 20, units = 'cm', dpi = 'print')
df = read.csv("../data/raw/purification_fluorescence.csv")
# 15 ul, sample volumes in file in ml
measurement_volume = 15 / 1000
df$fluorescence_sample = df$fluorescence / measurement_volume * df$sample_volume
ggplot(df, aes(x = reorder(sample, measurement), y = fluorescence_sample, fill = stage)) +
geom_col() +
labs(title = "Fluorescence measuremens during purification", x = "Sample", y = "Flourescence (586nm emission, 555nm extinction") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90)) +
ggsave('../img/purification_fluorescence.png', width = 20, units = 'cm', dpi = 'print')
names(df$stage_name) = stage
names(df$stage_name) = df$stage
ggplot(df, aes(x = reorder(sample, measurement), y = fluorescence_sample, fill = stage_name)) +
geom_col() +
labs(title = "Fluorescence measuremens during purification", x = "Sample", y = "Flourescence (586nm emission, 555nm extinction") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90)) +
ggsave('../img/purification_fluorescence.png', width = 20, units = 'cm', dpi = 'print')
df = read.csv("../data/raw/purification_fluorescence.csv")
names(df$stage) = df$stage_order
# 15 ul, sample volumes in file in ml
measurement_volume = 15 / 1000
df$fluorescence_sample = df$fluorescence / measurement_volume * df$sample_volume
ggplot(df, aes(x = reorder(sample, measurement), y = fluorescence_sample, fill = stage)) +
geom_col() +
labs(title = "Fluorescence measuremens during purification", x = "Sample", y = "Flourescence (586nm emission, 555nm extinction") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90)) +
ggsave('../img/purification_fluorescence.png', width = 20, units = 'cm', dpi = 'print')
ggplot(df, aes(x = reorder(sample, measurement), y = fluorescence_sample, fill = stage)) +
geom_col() +
labs(title = "Fluorescence measurements during purification", x = "Sample", y = "Flourescence (586nm emission, 555nm extinction") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90)) +
ggsave('../img/purification_fluorescence.png', width = 20, units = 'cm', dpi = 'print')
5e+06
5e+06-500000
5e+06-5000000
1000000-1e6
View(df)
df = read.csv("../data/raw/purification_fluorescence.csv")
names(df$stage) = df$stage_order
# 15 ul, sample volumes in file in ml
measurement_volume = 15 / 1000
df$fluorescence_sample = df$fluorescence / measurement_volume * df$sample_volume
ggplot(df, aes(x = reorder(sample, measurement), y = fluorescence_sample, fill = stage)) +
geom_col() +
labs(title = "Fluorescence measurements during purification", x = "Sample", y = "Flourescence (586nm emission, 555nm extinction") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90)) +
ggsave('../img/purification_fluorescence.png', width = 20, units = 'cm', dpi = 'print')
df = read.csv("../data/raw/purification_fluorescence.csv")
names(df$stage) = df$stage_order
# 15 ul, sample volumes in file in ml
measurement_volume = 15 / 1000
df$fluorescence_sample = df$fluorescence / measurement_volume * df$sample_volume
ggplot(df, aes(x = reorder(sample, measurement), y = fluorescence_sample, fill = stage)) +
geom_col() +
labs(title = "Fluorescence measurements during purification", x = "Sample", y = "Flourescence (586nm emission, 555nm extinction") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90)) +
ggsave('../img/purification_fluorescence.png', width = 20, units = 'cm', dpi = 'print')
df_wide = read.csv("../data/raw/reduction_quinol.csv")
df_full = gather(df_wide, series, absorption, wt_sol:neg_lipo)
df_full$series = factor(df_full$series)
df_full$protein[grepl('wt_', df_full$series, fixed=TRUE)] = 'wildtype'
df_full$protein[grepl('mut_', df_full$series, fixed=TRUE)] = 'mutant'
df_full$protein[grepl('neg_', df_full$series, fixed=TRUE)] = 'negative control'
df_full$state[grepl('_sol', df_full$series, fixed=TRUE)] = 'solubilized'
df_full$state[grepl('_lipo', df_full$series, fixed=TRUE)] = 'liposomes'
df_full$protein = factor(df_full$protein)
df_full$state = factor(df_full$state)
absorption_base = df_full %>%
filter(protein %in% c('mutant', 'wildtype') & between(time, 0.8, 0.9)) %>%
group_by(protein, state) %>%
summarize(n_base = n(), max_absorption_base = max(absorption), min_absorption_base = min(absorption), avg_absorption_base = mean(absorption))
absorption_base
absorption_quinone = df_full %>%
filter(protein %in% c('mutant', 'wildtype') & between(time, 2.5, 2.6)) %>%
group_by(protein, state) %>%
summarize(n_quinone = n(), max_absorption_quinone = max(absorption), min_absorption_quinone = min(absorption), avg_absorption_quinone = mean(absorption))
absorption_quinone
absorption_reduced = df_full %>%
filter(protein %in% c('mutant', 'wildtype') & between(time, 3.9, 4)) %>%
group_by(protein, state) %>%
summarize(n_quinone = n(), max_absorption_reduced = max(absorption), min_absorption_reduced = min(absorption), avg_absorption_reduced = mean(absorption))
absorption_reduced
absorption = absorption_base %>%
left_join(absorption_quinone, by = c('protein', 'state')) %>%
left_join(absorption_reduced, by = c('protein', 'state')) %>%
select(protein, state, avg_absorption_base, avg_absorption_quinone, avg_absorption_reduced) %>%
mutate(relative_reduction = (avg_absorption_quinone - avg_absorption_base) / (avg_absorption_reduced - avg_absorption_base))
absorption
write.csv(absorption, '../data/reduction_quinol.csv', row.names = FALSE)
ggplot(df_full, aes(x = time, y = absorption, color = series)) +
geom_point(size = 0.1) +
geom_line() +
facet_wrap(vars(protein), ncol = 1) +
coord_cartesian(ylim=c(0, 0.4)) +
labs(title = "Reduction of HS under quinone addition", x = "Time [min]", y = "Absorption at 428nm") +
theme_minimal() +
ggsave('../img/reduction_quinol.png', width = 20, units = 'cm', dpi = 'print')
ggplot(df_full, aes(x = time, y = absorption, color = series)) +
geom_point(size = 0.1) +
geom_line() +
facet_wrap(vars(protein), ncol = 1) +
coord_cartesian(ylim=c(0, 0.4)) +
labs(title = "Reduction of HS under quinol addition", x = "Time [min]", y = "Absorption at 428nm") +
theme_minimal() +
ggsave('../img/reduction_quinol.png', width = 20, units = 'cm', dpi = 'print')
df_reduction = read.csv('../data/reduction_quinol.csv')
ggplot(df_reduction, aes(x = protein, y = relative_reduction, fill = state)) +
geom_col(position = position_dodge()) +
scale_y_continuous(labels = scales::percent) +
labs(title = "Relative reduction of HS under quinol addition", x = "Sample", y = "Reduction [%]") +
theme_minimal() +
ggsave('../img/reduction_quinol_relative.png', width = 20, units = 'cm', dpi = 'print')
absorption
df_wide = read.csv("../data/raw/reduction_superox.csv")
df_full = gather(df_wide, series, absorption, wt_sol:neg_lipo)
df_full$series = factor(df_full$series)
df_full$protein[grepl('wt_', df_full$series, fixed=TRUE)] = 'wildtype'
df_full$protein[grepl('mut_', df_full$series, fixed=TRUE)] = 'mutant'
df_full$protein[grepl('neg_', df_full$series, fixed=TRUE)] = 'negative control'
df_full$state[grepl('_sol', df_full$series, fixed=TRUE)] = 'solubilized'
df_full$state[grepl('_lipo', df_full$series, fixed=TRUE)] = 'liposomes'
df_full$sod = ifelse(grepl('_sod', df_full$series, fixed=TRUE), TRUE, FALSE)
df_full$protein = factor(df_full$protein)
df_full$state = factor(df_full$state)
df_full$sod = factor(df_full$sod)
absorption_base = df_full %>%
filter(protein %in% c('mutant', 'wildtype') & between(time, 0.8, 0.9)) %>%
group_by(protein, state, sod) %>%
summarize(n_base = n(), max_absorption_base = max(absorption), min_absorption_base = min(absorption), avg_absorption_base = mean(absorption))
absorption_base
absorption_quinone = df_full %>%
filter(protein %in% c('mutant', 'wildtype') & between(time, 2.5, 2.6)) %>%
group_by(protein, state, sod) %>%
summarize(n_quinone = n(), max_absorption_quinone = max(absorption), min_absorption_quinone = min(absorption), avg_absorption_quinone = mean(absorption))
absorption_quinone
absorption_reduced = df_full %>%
filter(protein %in% c('mutant', 'wildtype') & between(time, 3.9, 4)) %>%
group_by(protein, state, sod) %>%
summarize(n_quinone = n(), max_absorption_reduced = max(absorption), min_absorption_reduced = min(absorption), avg_absorption_reduced = mean(absorption))
absorption_reduced
absorption = absorption_base %>%
left_join(absorption_quinone, by = c('protein', 'state', 'sod')) %>%
left_join(absorption_reduced, by = c('protein', 'state', 'sod')) %>%
select(protein, state, sod, avg_absorption_base, avg_absorption_quinone, avg_absorption_reduced) %>%
mutate(relative_reduction = (avg_absorption_quinone - avg_absorption_base) / (avg_absorption_reduced - avg_absorption_base))
absorption
write.csv(absorption, '../data/reduction_superox.csv', row.names = FALSE)
ggplot(df_full, aes(x = time, y = absorption, color = series)) +
geom_point(size = 0.1) +
geom_line() +
facet_wrap(vars(protein, state), ncol = 2) +
coord_cartesian(ylim=c(0, 0.4)) +
labs(title = "Reduction of HS under superoxide addition", x = "Time [min]", y = "Absorption at 428nm") +
theme_minimal() +
ggsave('../img/reduction_superox.png', width = 20, units = 'cm', dpi = 'print')
absorption
df_wide = read.csv("../data/raw/dsred_cleavage_fluorescence.csv")
df_full = gather(df_wide, series, intensity, dsred_5ul:lipo_uncleaved_275ul_cu_edta)
df_full$series = factor(df_full$series)
df_full$protein[grepl('dsred_', df_full$series, fixed=TRUE)] = 'dsRed'
df_full$protein[grepl('lipo_cleaved', df_full$series, fixed=TRUE)] = 'Liposomes uncleaved'
df_full$protein[grepl('lipo_uncleaved', df_full$series, fixed=TRUE)] = 'Liposomes cleaved'
df_full$protein = factor(df_full$protein)
df_full$copper = ifelse(grepl('_cu', df_full$series, fixed=TRUE), TRUE, FALSE)
df_full$edta = ifelse(grepl('_edta', df_full$series, fixed=TRUE), TRUE, FALSE)
df_full$copper = factor(df_full$copper)
df_full$edta = factor(df_full$edta)
# Custom facet labels
copper.labs <- c("+Copper", "")
names(copper.labs) <- c(TRUE, FALSE)
edta.labs <- c("+EDTA", "")
names(edta.labs) <- c(TRUE, FALSE)
ggplot(df_full, aes(x = wavelength, y = intensity, color = series)) +
geom_point(size = 0.1) +
geom_line() +
facet_wrap(
vars(protein, copper, edta),
ncol = 3,
labeller = labeller(copper = copper.labs, edta = edta.labs)
) +
coord_cartesian(xlim=c(570, 700), ylim=c(0, 100)) +
labs(title = "Fluorescence & quenching of HS at 555nm", subtitle = "Liposomes & solubilized", x = "Wavelength [nm]", y = "Intensity") +
theme_minimal() +
ggsave('../img/dsred_cleavage_fluorescence.png', width = 20, units = 'cm', dpi = 'print')
df_wide_hs = read.csv("../data/raw/activity_mut_hs_conc.csv")
df_full_hs = gather(df_wide_hs, series, absorption, ref_xo:hs_9ul)
df_full_hs$series = factor(df_full_hs$series)
ggplot(df_full_hs, aes(x = time, y = absorption, color = series)) +
geom_point(size = 0.1) +
geom_line() +
#coord_cartesian(ylim=c(0, 0.4)) +
labs(title = "Determination of ideal HS concentration", subtitle = 'Mutant', x = "Time [min]", y = "Absorption at 455nm") +
theme_minimal() +
ggsave('../img/activity_mut_hs.png', width = 20, units = 'cm', dpi = 'print')
df_wide_qn = read.csv("../data/raw/activity_mut_quinone.csv")
df_full_qn = gather(df_wide_qn, series, absorption, quinone_50uM:quinone_0.25uM)
df_full_qn$series = factor(df_full_qn$series)
ggplot(df_full_qn, aes(x = time, y = absorption, color = series)) +
geom_point(size = 0.1) +
geom_line() +
#coord_cartesian(ylim=c(0, 0.4)) +
labs(title = "Determination of Michaelis constant of HS", subtitle = 'Mutant', x = "Time [min]", y = "Absorption at 455nm") +
theme_minimal() +
ggsave('../img/activity_mut_quinone.png', width = 20, units = 'cm', dpi = 'print')
df_slopes_long = read.csv('../data/raw/activity_mut_quinone_slope.csv')
df_slopes_long$type = ifelse(df_slopes_long$start == 0.7, 'XO', 'HS')
df_slopes_wide = spread(df_slopes_long %>% select(sample, slope, type, concentration), type, slope)
sod_slope = (df_slopes_wide %>% filter(sample == 'SOD'))$HS
avg_xo_slope = (df_slopes_wide %>% filter(sample != 'SOD') %>% summarize(avg=mean(XO)))$avg
# We want to know how much the reduction of the dye was quenched, as this corresponds with the enzymatic activity.
df_slopes_wide$relative_reduction = 1 - df_slopes_wide$HS / (avg_xo_slope - sod_slope)
df_slopes = df_slopes_wide %>% filter(sample != 'SOD')
df_slopes$concentration_inverse = 1 / df_slopes$concentration
df_slopes$relative_reduction_inverse = 1 / df_slopes$relative_reduction
ggplot(df_slopes, aes(x = concentration, y = relative_reduction)) +
geom_point() +
geom_line() +
#coord_cartesian(ylim=c(0, 0.4)) +
labs(title = "Determination of HS KM", subtitle = 'Mutant', x = "Concentration [uM]", y = "Relative superoxide reduction [%]") +
theme_minimal() +
ggsave('../img/activity_mut_km.png', width = 20, units = 'cm', dpi = 'print')
ggplot(df_slopes, aes(x = concentration_inverse, y = relative_reduction_inverse)) +
geom_point() +
geom_smooth(method = 'lm', se = FALSE) +
stat_regline_equation(label.x = 3, label.y = 2) +
labs(title = "Determination of HS KM", subtitle = 'Mutant', x = "1 / concentration [1 / uM]", y = "1 / Relative superoxide reduction [1 / %]") +
theme_minimal() +
ggsave('../img/activity_mut_km_lb.png', width = 20, units = 'cm', dpi = 'print')
library(ggpubr)
library(dplyr)
library(scales)
library(tidyr)
library(viridis)
df_wide_hs = read.csv("../data/raw/activity_mut_hs_conc.csv")
df_full_hs = gather(df_wide_hs, series, absorption, ref_xo:hs_9ul)
df_full_hs$series = factor(df_full_hs$series)
ggplot(df_full_hs, aes(x = time, y = absorption, color = series)) +
geom_point(size = 0.1) +
geom_line() +
#coord_cartesian(ylim=c(0, 0.4)) +
labs(title = "Determination of ideal HS concentration", subtitle = 'Mutant', x = "Time [min]", y = "Absorption at 455nm") +
theme_minimal() +
ggsave('../img/activity_mut_hs.png', width = 20, units = 'cm', dpi = 'print')
df_wide_qn = read.csv("../data/raw/activity_mut_quinone.csv")
df_full_qn = gather(df_wide_qn, series, absorption, quinone_50uM:quinone_0.25uM)
df_full_qn$series = factor(df_full_qn$series)
ggplot(df_full_qn, aes(x = time, y = absorption, color = series)) +
geom_point(size = 0.1) +
geom_line() +
#coord_cartesian(ylim=c(0, 0.4)) +
labs(title = "Determination of Michaelis constant of HS", subtitle = 'Mutant', x = "Time [min]", y = "Absorption at 455nm") +
theme_minimal() +
ggsave('../img/activity_mut_quinone.png', width = 20, units = 'cm', dpi = 'print')
df_slopes_long = read.csv('../data/raw/activity_mut_quinone_slope.csv')
df_slopes_long$type = ifelse(df_slopes_long$start == 0.7, 'XO', 'HS')
df_slopes_wide = spread(df_slopes_long %>% select(sample, slope, type, concentration), type, slope)
sod_slope = (df_slopes_wide %>% filter(sample == 'SOD'))$HS
avg_xo_slope = (df_slopes_wide %>% filter(sample != 'SOD') %>% summarize(avg=mean(XO)))$avg
# We want to know how much the reduction of the dye was quenched, as this corresponds with the enzymatic activity.
df_slopes_wide$relative_reduction = 1 - df_slopes_wide$HS / (avg_xo_slope - sod_slope)
df_slopes = df_slopes_wide %>% filter(sample != 'SOD')
df_slopes$concentration_inverse = 1 / df_slopes$concentration
df_slopes$relative_reduction_inverse = 1 / df_slopes$relative_reduction
ggplot(df_slopes, aes(x = concentration, y = relative_reduction)) +
geom_point() +
geom_line() +
#coord_cartesian(ylim=c(0, 0.4)) +
labs(title = "Determination of HS KM", subtitle = 'Mutant', x = "Concentration [uM]", y = "Relative superoxide reduction [%]") +
theme_minimal() +
ggsave('../img/activity_mut_km.png', width = 20, units = 'cm', dpi = 'print')
ggplot(df_slopes, aes(x = concentration_inverse, y = relative_reduction_inverse)) +
geom_point() +
geom_smooth(method = 'lm', se = FALSE) +
stat_regline_equation(label.x = 3, label.y = 2) +
labs(title = "Determination of HS KM", subtitle = 'Mutant', x = "1 / concentration [1 / uM]", y = "1 / Relative superoxide reduction [1 / %]") +
theme_minimal() +
ggsave('../img/activity_mut_km_lb.png', width = 20, units = 'cm', dpi = 'print')
ggplot(df_full_hs, aes(x = time, y = absorption, color = series)) +
geom_point(size = 0.1) +
geom_line() +
#coord_cartesian(ylim=c(0, 0.4)) +
labs(title = "Determination of ideal HS concentration", subtitle = 'Mutant', x = "Time [min]", y = "Absorption at 455nm") +
theme_minimal() +
ggsave('../img/activity_mut_hs.png', width = 20, units = 'cm', dpi = 'print')
ggplot(df_full_qn, aes(x = time, y = absorption, color = series)) +
geom_point(size = 0.1) +
geom_line() +
#coord_cartesian(ylim=c(0, 0.4)) +
labs(title = "Determination of Michaelis constant of HS", subtitle = 'Mutant', x = "Time [min]", y = "Absorption at 455nm") +
theme_minimal() +
ggsave('../img/activity_mut_quinone.png', width = 20, units = 'cm', dpi = 'print')
df_wide_hs = read.csv("../data/raw/activity_mut_hs_conc.csv")
df_full_hs = gather(df_wide_hs, series, absorption, ref_xo:hs_9ul)
df_full_hs$series = factor(df_full_hs$series)
ggplot(df_full_hs, aes(x = time, y = absorption, color = series)) +
geom_point(size = 0.1) +
geom_line() +
#coord_cartesian(ylim=c(0, 0.4)) +
labs(title = "Determination of ideal HS concentration", subtitle = 'Mutant', x = "Time [min]", y = "Absorption at 455nm") +
theme_minimal() +
ggsave('../img/activity_mut_hs.png', width = 20, units = 'cm', dpi = 'print')
df_wide_qn = read.csv("../data/raw/activity_mut_quinone.csv")
df_full_qn = gather(df_wide_qn, series, absorption, quinone_50uM:quinone_0.25uM)
df_full_qn$series = factor(df_full_qn$series)
ggplot(df_full_qn, aes(x = time, y = absorption, color = series)) +
geom_point(size = 0.1) +
geom_line() +
#coord_cartesian(ylim=c(0, 0.4)) +
labs(title = "Determination of Michaelis constant of HS", subtitle = 'Mutant', x = "Time [min]", y = "Absorption at 455nm") +
theme_minimal() +
ggsave('../img/activity_mut_quinone.png', width = 20, units = 'cm', dpi = 'print')
df_slopes_long = read.csv('../data/raw/activity_mut_quinone_slope.csv')
df_slopes_long$type = ifelse(df_slopes_long$start == 0.7, 'XO', 'HS')
df_slopes_wide = spread(df_slopes_long %>% select(sample, slope, type, concentration), type, slope)
sod_slope = (df_slopes_wide %>% filter(sample == 'SOD'))$HS
avg_xo_slope = (df_slopes_wide %>% filter(sample != 'SOD') %>% summarize(avg=mean(XO)))$avg
# We want to know how much the reduction of the dye was quenched, as this corresponds with the enzymatic activity.
df_slopes_wide$relative_reduction = 1 - df_slopes_wide$HS / (avg_xo_slope - sod_slope)
df_slopes = df_slopes_wide %>% filter(sample != 'SOD')
df_slopes$concentration_inverse = 1 / df_slopes$concentration
df_slopes$relative_reduction_inverse = 1 / df_slopes$relative_reduction
ggplot(df_slopes, aes(x = concentration, y = relative_reduction)) +
geom_point() +
geom_line() +
#coord_cartesian(ylim=c(0, 0.4)) +
labs(title = "Determination of HS KM", subtitle = 'Mutant', x = "Concentration [uM]", y = "Relative superoxide reduction [%]") +
theme_minimal() +
ggsave('../img/activity_mut_km.png', width = 20, units = 'cm', dpi = 'print')
ggplot(df_slopes, aes(x = concentration_inverse, y = relative_reduction_inverse)) +
geom_point() +
geom_smooth(method = 'lm', se = FALSE) +
stat_regline_equation(label.x = 3, label.y = 2) +
labs(title = "Determination of HS KM", subtitle = 'Mutant', x = "1 / concentration [1 / uM]", y = "1 / Relative superoxide reduction [1 / %]") +
theme_minimal() +
ggsave('../img/activity_mut_km_lb.png', width = 20, units = 'cm', dpi = 'print')
ggplot(df_slopes, aes(x = concentration, y = relative_reduction)) +
geom_point() +
geom_line() +
#coord_cartesian(ylim=c(0, 0.4)) +
labs(title = "Determination of HS KM", subtitle = 'Mutant', x = "Concentration [uM]", y = "Relative superoxide oxidation [%]") +
theme_minimal() +
ggsave('../img/activity_mut_km.png', width = 20, units = 'cm', dpi = 'print')
ggplot(df_slopes, aes(x = concentration_inverse, y = relative_reduction_inverse)) +
geom_point() +
geom_smooth(method = 'lm', se = FALSE) +
stat_regline_equation(label.x = 3, label.y = 2) +
labs(title = "Determination of HS KM", subtitle = 'Mutant', x = "1 / concentration [1 / uM]", y = "1 / Relative superoxide oxidation [1 / %]") +
theme_minimal() +
ggsave('../img/activity_mut_km_lb.png', width = 20, units = 'cm', dpi = 'print')
df_wide_hs = read.csv("../data/raw/activity_wt_hs_conc.csv")
df_full_hs = gather(df_wide_hs, series, absorption, ref_xo:hs_0.25ul)
df_full_hs$series = factor(df_full_hs$series)
ggplot(df_full_hs, aes(x = time, y = absorption, color = series)) +
geom_point(size = 0.1) +
geom_line() +
#coord_cartesian(ylim=c(0, 0.4)) +
labs(title = "Determination of ideal HS concentration", subtitle = "Wildtype", x = "Time [min]", y = "Absorption at 455nm") +
theme_minimal() +
ggsave('../img/activity_wt_hs.png', width = 20, units = 'cm', dpi = 'print')
df_wide_qn = read.csv("../data/raw/activity_wt_quinone.csv")
df_full_qn = gather(df_wide_qn, series, absorption, quinone_50uM:quinone_0.01uM)
df_full_qn$series = factor(df_full_qn$series)
ggplot(df_full_qn, aes(x = time, y = absorption, color = series)) +
geom_point(size = 0.1) +
geom_line() +
#coord_cartesian(ylim=c(0, 0.4)) +
labs(title = "Determination of Michaelis constant of HS", subtitle = "Wildtype", x = "Time [min]", y = "Absorption at 455nm") +
theme_minimal() +
ggsave('../img/activity_wt_quinone.png', width = 20, units = 'cm', dpi = 'print')
df_slopes_long = read.csv('../data/raw/activity_wt_quinone_slope.csv')
df_slopes_long$type = ifelse(df_slopes_long$start == 0.65, 'XO', 'HS')
df_slopes_wide = spread(df_slopes_long %>% select(sample, slope, type, concentration), type, slope)
sod_slope = (df_slopes_wide %>% filter(sample == 'SOD'))$HS
avg_xo_slope = (df_slopes_wide %>% filter(sample != 'SOD') %>% summarize(avg=mean(XO)))$avg
# We want to know how much the reduction of the dye was quenched, as this corresponds with the enzymatic activity.
df_slopes_wide$relative_reduction = 1 - df_slopes_wide$HS / (avg_xo_slope - sod_slope)
df_slopes = df_slopes_wide %>% filter(sample != 'SOD')
df_slopes$concentration_inverse = 1 / df_slopes$concentration
df_slopes$relative_reduction_inverse = 1 / df_slopes$relative_reduction
ggplot(df_slopes, aes(x = concentration, y = relative_reduction)) +
geom_point() +
geom_line() +
#coord_cartesian(ylim=c(0, 0.4)) +
labs(title = "Determination of HS KM", subtitle = 'Wildtype', x = "Concentration [uM]", y = "Relative superoxide reduction [%]") +
theme_minimal() +
ggsave('../img/activity_wt_km.png', width = 20, units = 'cm', dpi = 'print')
ggplot(df_slopes, aes(x = concentration_inverse, y = relative_reduction_inverse)) +
geom_point() +
geom_smooth(method = 'lm', se = FALSE) +
stat_regline_equation(label.x = 75, label.y = 1.72) +
labs(title = "Determination of HS KM", subtitle = 'Wildtype', x = "1 / concentration [1 / uM]", y = "1 / Relative superoxide reduction [1 / %]") +
theme_minimal() +
ggsave('../img/activity_wt_km_lb.png', width = 20, units = 'cm', dpi = 'print')
ggplot(df_slopes, aes(x = concentration, y = relative_reduction)) +
geom_point() +
geom_line() +
#coord_cartesian(ylim=c(0, 0.4)) +
labs(title = "Determination of HS KM", subtitle = 'Wildtype', x = "Concentration [uM]", y = "Relative superoxide oxidation [%]") +
theme_minimal() +
ggsave('../img/activity_wt_km.png', width = 20, units = 'cm', dpi = 'print')
ggplot(df_slopes, aes(x = concentration_inverse, y = relative_reduction_inverse)) +
geom_point() +
geom_smooth(method = 'lm', se = FALSE) +
stat_regline_equation(label.x = 75, label.y = 1.72) +
labs(title = "Determination of HS KM", subtitle = 'Wildtype', x = "1 / concentration [1 / uM]", y = "1 / Relative superoxide oxidation [1 / %]") +
theme_minimal() +
ggsave('../img/activity_wt_km_lb.png', width = 20, units = 'cm', dpi = 'print')
ggplot(df_slopes, aes(x = concentration_inverse, y = relative_reduction_inverse)) +
geom_point() +
ylim(0, NA) +
geom_smooth(method = 'lm', se = FALSE) +
stat_regline_equation(label.x = 75, label.y = 1.72) +
labs(title = "Determination of HS KM", subtitle = 'Wildtype', x = "1 / concentration [1 / uM]", y = "1 / Relative superoxide oxidation [1 / %]") +
theme_minimal() +
ggsave('../img/activity_wt_km_lb.png', width = 20, units = 'cm', dpi = 'print')
ggplot(df_slopes, aes(x = concentration_inverse, y = relative_reduction_inverse)) +
geom_point() +
geom_smooth(method = 'lm', se = FALSE) +
stat_regline_equation(label.x = 75, label.y = 1.72) +
labs(title = "Determination of HS KM", subtitle = 'Wildtype', x = "1 / concentration [1 / uM]", y = "1 / Relative superoxide oxidation [1 / %]") +
theme_minimal() +
ggsave('../img/activity_wt_km_lb.png', width = 20, units = 'cm', dpi = 'print')
