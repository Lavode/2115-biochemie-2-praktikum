names(copper.labs) <- c(TRUE, FALSE)
edta.labs <- c("+EDTA", "")
names(edta.labs) <- c(TRUE, FALSE)
ggplot(df_full, aes(x = wavelength, y = intensity, color = series)) +
geom_point(size = 0.1) +
geom_line() +
facet_wrap(
vars(protein, copper, edta),
ncol = 3,
labeller = labeller(copper = copper.labs, edta = edta.labs)
) +
coord_cartesian(xlim=c(570, 700), ylim=c(0, 100)) +
labs(title = "Fluorescence & quenching of HS at 555nm", subtitle = "Liposomes & solubilized", x = "Wavelength [nm]", y = "Intensity") +
theme_minimal() +
ggsave('../img/dsred_cleavage_fluorescence.png', width = 20, units = 'cm', dpi = 'print')
df_wide_hs = read.csv("../data/raw/activity_mut_hs_conc.csv")
df_full_hs = gather(df_wide_hs, series, absorption, ref_xo:hs_9ul)
df_full_hs$series = factor(df_full_hs$series)
ggplot(df_full_hs, aes(x = time, y = absorption, color = series)) +
geom_point(size = 0.1) +
geom_line() +
#coord_cartesian(ylim=c(0, 0.4)) +
labs(title = "Determination of ideal HS concentration", subtitle = 'Mutant', x = "Time [min]", y = "Absorption at 455nm") +
theme_minimal() +
ggsave('../img/activity_mut_hs.png', width = 20, units = 'cm', dpi = 'print')
df_wide_qn = read.csv("../data/raw/activity_mut_quinone.csv")
df_full_qn = gather(df_wide_qn, series, absorption, quinone_50uM:quinone_0.25uM)
df_full_qn$series = factor(df_full_qn$series)
ggplot(df_full_qn, aes(x = time, y = absorption, color = series)) +
geom_point(size = 0.1) +
geom_line() +
#coord_cartesian(ylim=c(0, 0.4)) +
labs(title = "Determination of Michaelis constant of HS", subtitle = 'Mutant', x = "Time [min]", y = "Absorption at 455nm") +
theme_minimal() +
ggsave('../img/activity_mut_quinone.png', width = 20, units = 'cm', dpi = 'print')
df_slopes_long = read.csv('../data/raw/activity_mut_quinone_slope.csv')
df_slopes_long$type = ifelse(df_slopes_long$start == 0.7, 'XO', 'HS')
df_slopes_wide = spread(df_slopes_long %>% select(sample, slope, type, concentration), type, slope)
sod_slope = (df_slopes_wide %>% filter(sample == 'SOD'))$HS
avg_xo_slope = (df_slopes_wide %>% filter(sample != 'SOD') %>% summarize(avg=mean(XO)))$avg
# We want to know how much the reduction of the dye was quenched, as this corresponds with the enzymatic activity.
df_slopes_wide$relative_reduction = 1 - df_slopes_wide$HS / (avg_xo_slope - sod_slope)
df_slopes = df_slopes_wide %>% filter(sample != 'SOD')
df_slopes$concentration_inverse = 1 / df_slopes$concentration
df_slopes$relative_reduction_inverse = 1 / df_slopes$relative_reduction
ggplot(df_slopes, aes(x = concentration, y = relative_reduction)) +
geom_point() +
geom_line() +
#coord_cartesian(ylim=c(0, 0.4)) +
labs(title = "Determination of HS KM", subtitle = 'Mutant', x = "Concentration [uM]", y = "Relative superoxide reduction [%]") +
theme_minimal() +
ggsave('../img/activity_mut_km.png', width = 20, units = 'cm', dpi = 'print')
ggplot(df_slopes, aes(x = concentration_inverse, y = relative_reduction_inverse)) +
geom_point() +
geom_smooth(method = 'lm', se = FALSE) +
stat_regline_equation(label.x = 3, label.y = 2) +
labs(title = "Determination of HS KM", subtitle = 'Mutant', x = "1 / concentration [1 / uM]", y = "1 / Relative superoxide reduction [1 / %]") +
theme_minimal() +
ggsave('../img/activity_mut_km_lb.png', width = 20, units = 'cm', dpi = 'print')
library(ggpubr)
library(dplyr)
library(scales)
library(tidyr)
library(viridis)
df_wide_hs = read.csv("../data/raw/activity_mut_hs_conc.csv")
df_full_hs = gather(df_wide_hs, series, absorption, ref_xo:hs_9ul)
df_full_hs$series = factor(df_full_hs$series)
ggplot(df_full_hs, aes(x = time, y = absorption, color = series)) +
geom_point(size = 0.1) +
geom_line() +
#coord_cartesian(ylim=c(0, 0.4)) +
labs(title = "Determination of ideal HS concentration", subtitle = 'Mutant', x = "Time [min]", y = "Absorption at 455nm") +
theme_minimal() +
ggsave('../img/activity_mut_hs.png', width = 20, units = 'cm', dpi = 'print')
df_wide_qn = read.csv("../data/raw/activity_mut_quinone.csv")
df_full_qn = gather(df_wide_qn, series, absorption, quinone_50uM:quinone_0.25uM)
df_full_qn$series = factor(df_full_qn$series)
ggplot(df_full_qn, aes(x = time, y = absorption, color = series)) +
geom_point(size = 0.1) +
geom_line() +
#coord_cartesian(ylim=c(0, 0.4)) +
labs(title = "Determination of Michaelis constant of HS", subtitle = 'Mutant', x = "Time [min]", y = "Absorption at 455nm") +
theme_minimal() +
ggsave('../img/activity_mut_quinone.png', width = 20, units = 'cm', dpi = 'print')
df_slopes_long = read.csv('../data/raw/activity_mut_quinone_slope.csv')
df_slopes_long$type = ifelse(df_slopes_long$start == 0.7, 'XO', 'HS')
df_slopes_wide = spread(df_slopes_long %>% select(sample, slope, type, concentration), type, slope)
sod_slope = (df_slopes_wide %>% filter(sample == 'SOD'))$HS
avg_xo_slope = (df_slopes_wide %>% filter(sample != 'SOD') %>% summarize(avg=mean(XO)))$avg
# We want to know how much the reduction of the dye was quenched, as this corresponds with the enzymatic activity.
df_slopes_wide$relative_reduction = 1 - df_slopes_wide$HS / (avg_xo_slope - sod_slope)
df_slopes = df_slopes_wide %>% filter(sample != 'SOD')
df_slopes$concentration_inverse = 1 / df_slopes$concentration
df_slopes$relative_reduction_inverse = 1 / df_slopes$relative_reduction
ggplot(df_slopes, aes(x = concentration, y = relative_reduction)) +
geom_point() +
geom_line() +
#coord_cartesian(ylim=c(0, 0.4)) +
labs(title = "Determination of HS KM", subtitle = 'Mutant', x = "Concentration [uM]", y = "Relative superoxide reduction [%]") +
theme_minimal() +
ggsave('../img/activity_mut_km.png', width = 20, units = 'cm', dpi = 'print')
ggplot(df_slopes, aes(x = concentration_inverse, y = relative_reduction_inverse)) +
geom_point() +
geom_smooth(method = 'lm', se = FALSE) +
stat_regline_equation(label.x = 3, label.y = 2) +
labs(title = "Determination of HS KM", subtitle = 'Mutant', x = "1 / concentration [1 / uM]", y = "1 / Relative superoxide reduction [1 / %]") +
theme_minimal() +
ggsave('../img/activity_mut_km_lb.png', width = 20, units = 'cm', dpi = 'print')
ggplot(df_full_hs, aes(x = time, y = absorption, color = series)) +
geom_point(size = 0.1) +
geom_line() +
#coord_cartesian(ylim=c(0, 0.4)) +
labs(title = "Determination of ideal HS concentration", subtitle = 'Mutant', x = "Time [min]", y = "Absorption at 455nm") +
theme_minimal() +
ggsave('../img/activity_mut_hs.png', width = 20, units = 'cm', dpi = 'print')
ggplot(df_full_qn, aes(x = time, y = absorption, color = series)) +
geom_point(size = 0.1) +
geom_line() +
#coord_cartesian(ylim=c(0, 0.4)) +
labs(title = "Determination of Michaelis constant of HS", subtitle = 'Mutant', x = "Time [min]", y = "Absorption at 455nm") +
theme_minimal() +
ggsave('../img/activity_mut_quinone.png', width = 20, units = 'cm', dpi = 'print')
df_wide_hs = read.csv("../data/raw/activity_mut_hs_conc.csv")
df_full_hs = gather(df_wide_hs, series, absorption, ref_xo:hs_9ul)
df_full_hs$series = factor(df_full_hs$series)
ggplot(df_full_hs, aes(x = time, y = absorption, color = series)) +
geom_point(size = 0.1) +
geom_line() +
#coord_cartesian(ylim=c(0, 0.4)) +
labs(title = "Determination of ideal HS concentration", subtitle = 'Mutant', x = "Time [min]", y = "Absorption at 455nm") +
theme_minimal() +
ggsave('../img/activity_mut_hs.png', width = 20, units = 'cm', dpi = 'print')
df_wide_qn = read.csv("../data/raw/activity_mut_quinone.csv")
df_full_qn = gather(df_wide_qn, series, absorption, quinone_50uM:quinone_0.25uM)
df_full_qn$series = factor(df_full_qn$series)
ggplot(df_full_qn, aes(x = time, y = absorption, color = series)) +
geom_point(size = 0.1) +
geom_line() +
#coord_cartesian(ylim=c(0, 0.4)) +
labs(title = "Determination of Michaelis constant of HS", subtitle = 'Mutant', x = "Time [min]", y = "Absorption at 455nm") +
theme_minimal() +
ggsave('../img/activity_mut_quinone.png', width = 20, units = 'cm', dpi = 'print')
df_slopes_long = read.csv('../data/raw/activity_mut_quinone_slope.csv')
df_slopes_long$type = ifelse(df_slopes_long$start == 0.7, 'XO', 'HS')
df_slopes_wide = spread(df_slopes_long %>% select(sample, slope, type, concentration), type, slope)
sod_slope = (df_slopes_wide %>% filter(sample == 'SOD'))$HS
avg_xo_slope = (df_slopes_wide %>% filter(sample != 'SOD') %>% summarize(avg=mean(XO)))$avg
# We want to know how much the reduction of the dye was quenched, as this corresponds with the enzymatic activity.
df_slopes_wide$relative_reduction = 1 - df_slopes_wide$HS / (avg_xo_slope - sod_slope)
df_slopes = df_slopes_wide %>% filter(sample != 'SOD')
df_slopes$concentration_inverse = 1 / df_slopes$concentration
df_slopes$relative_reduction_inverse = 1 / df_slopes$relative_reduction
ggplot(df_slopes, aes(x = concentration, y = relative_reduction)) +
geom_point() +
geom_line() +
#coord_cartesian(ylim=c(0, 0.4)) +
labs(title = "Determination of HS KM", subtitle = 'Mutant', x = "Concentration [uM]", y = "Relative superoxide reduction [%]") +
theme_minimal() +
ggsave('../img/activity_mut_km.png', width = 20, units = 'cm', dpi = 'print')
ggplot(df_slopes, aes(x = concentration_inverse, y = relative_reduction_inverse)) +
geom_point() +
geom_smooth(method = 'lm', se = FALSE) +
stat_regline_equation(label.x = 3, label.y = 2) +
labs(title = "Determination of HS KM", subtitle = 'Mutant', x = "1 / concentration [1 / uM]", y = "1 / Relative superoxide reduction [1 / %]") +
theme_minimal() +
ggsave('../img/activity_mut_km_lb.png', width = 20, units = 'cm', dpi = 'print')
ggplot(df_slopes, aes(x = concentration, y = relative_reduction)) +
geom_point() +
geom_line() +
#coord_cartesian(ylim=c(0, 0.4)) +
labs(title = "Determination of HS KM", subtitle = 'Mutant', x = "Concentration [uM]", y = "Relative superoxide oxidation [%]") +
theme_minimal() +
ggsave('../img/activity_mut_km.png', width = 20, units = 'cm', dpi = 'print')
ggplot(df_slopes, aes(x = concentration_inverse, y = relative_reduction_inverse)) +
geom_point() +
geom_smooth(method = 'lm', se = FALSE) +
stat_regline_equation(label.x = 3, label.y = 2) +
labs(title = "Determination of HS KM", subtitle = 'Mutant', x = "1 / concentration [1 / uM]", y = "1 / Relative superoxide oxidation [1 / %]") +
theme_minimal() +
ggsave('../img/activity_mut_km_lb.png', width = 20, units = 'cm', dpi = 'print')
df_wide_hs = read.csv("../data/raw/activity_wt_hs_conc.csv")
df_full_hs = gather(df_wide_hs, series, absorption, ref_xo:hs_0.25ul)
df_full_hs$series = factor(df_full_hs$series)
ggplot(df_full_hs, aes(x = time, y = absorption, color = series)) +
geom_point(size = 0.1) +
geom_line() +
#coord_cartesian(ylim=c(0, 0.4)) +
labs(title = "Determination of ideal HS concentration", subtitle = "Wildtype", x = "Time [min]", y = "Absorption at 455nm") +
theme_minimal() +
ggsave('../img/activity_wt_hs.png', width = 20, units = 'cm', dpi = 'print')
df_wide_qn = read.csv("../data/raw/activity_wt_quinone.csv")
df_full_qn = gather(df_wide_qn, series, absorption, quinone_50uM:quinone_0.01uM)
df_full_qn$series = factor(df_full_qn$series)
ggplot(df_full_qn, aes(x = time, y = absorption, color = series)) +
geom_point(size = 0.1) +
geom_line() +
#coord_cartesian(ylim=c(0, 0.4)) +
labs(title = "Determination of Michaelis constant of HS", subtitle = "Wildtype", x = "Time [min]", y = "Absorption at 455nm") +
theme_minimal() +
ggsave('../img/activity_wt_quinone.png', width = 20, units = 'cm', dpi = 'print')
df_slopes_long = read.csv('../data/raw/activity_wt_quinone_slope.csv')
df_slopes_long$type = ifelse(df_slopes_long$start == 0.65, 'XO', 'HS')
df_slopes_wide = spread(df_slopes_long %>% select(sample, slope, type, concentration), type, slope)
sod_slope = (df_slopes_wide %>% filter(sample == 'SOD'))$HS
avg_xo_slope = (df_slopes_wide %>% filter(sample != 'SOD') %>% summarize(avg=mean(XO)))$avg
# We want to know how much the reduction of the dye was quenched, as this corresponds with the enzymatic activity.
df_slopes_wide$relative_reduction = 1 - df_slopes_wide$HS / (avg_xo_slope - sod_slope)
df_slopes = df_slopes_wide %>% filter(sample != 'SOD')
df_slopes$concentration_inverse = 1 / df_slopes$concentration
df_slopes$relative_reduction_inverse = 1 / df_slopes$relative_reduction
ggplot(df_slopes, aes(x = concentration, y = relative_reduction)) +
geom_point() +
geom_line() +
#coord_cartesian(ylim=c(0, 0.4)) +
labs(title = "Determination of HS KM", subtitle = 'Wildtype', x = "Concentration [uM]", y = "Relative superoxide reduction [%]") +
theme_minimal() +
ggsave('../img/activity_wt_km.png', width = 20, units = 'cm', dpi = 'print')
ggplot(df_slopes, aes(x = concentration_inverse, y = relative_reduction_inverse)) +
geom_point() +
geom_smooth(method = 'lm', se = FALSE) +
stat_regline_equation(label.x = 75, label.y = 1.72) +
labs(title = "Determination of HS KM", subtitle = 'Wildtype', x = "1 / concentration [1 / uM]", y = "1 / Relative superoxide reduction [1 / %]") +
theme_minimal() +
ggsave('../img/activity_wt_km_lb.png', width = 20, units = 'cm', dpi = 'print')
ggplot(df_slopes, aes(x = concentration, y = relative_reduction)) +
geom_point() +
geom_line() +
#coord_cartesian(ylim=c(0, 0.4)) +
labs(title = "Determination of HS KM", subtitle = 'Wildtype', x = "Concentration [uM]", y = "Relative superoxide oxidation [%]") +
theme_minimal() +
ggsave('../img/activity_wt_km.png', width = 20, units = 'cm', dpi = 'print')
ggplot(df_slopes, aes(x = concentration_inverse, y = relative_reduction_inverse)) +
geom_point() +
geom_smooth(method = 'lm', se = FALSE) +
stat_regline_equation(label.x = 75, label.y = 1.72) +
labs(title = "Determination of HS KM", subtitle = 'Wildtype', x = "1 / concentration [1 / uM]", y = "1 / Relative superoxide oxidation [1 / %]") +
theme_minimal() +
ggsave('../img/activity_wt_km_lb.png', width = 20, units = 'cm', dpi = 'print')
ggplot(df_slopes, aes(x = concentration_inverse, y = relative_reduction_inverse)) +
geom_point() +
ylim(0, NA) +
geom_smooth(method = 'lm', se = FALSE) +
stat_regline_equation(label.x = 75, label.y = 1.72) +
labs(title = "Determination of HS KM", subtitle = 'Wildtype', x = "1 / concentration [1 / uM]", y = "1 / Relative superoxide oxidation [1 / %]") +
theme_minimal() +
ggsave('../img/activity_wt_km_lb.png', width = 20, units = 'cm', dpi = 'print')
ggplot(df_slopes, aes(x = concentration_inverse, y = relative_reduction_inverse)) +
geom_point() +
geom_smooth(method = 'lm', se = FALSE) +
stat_regline_equation(label.x = 75, label.y = 1.72) +
labs(title = "Determination of HS KM", subtitle = 'Wildtype', x = "1 / concentration [1 / uM]", y = "1 / Relative superoxide oxidation [1 / %]") +
theme_minimal() +
ggsave('../img/activity_wt_km_lb.png', width = 20, units = 'cm', dpi = 'print')
library(ggplot2)
library(ggrepel)
library(dplyr)
library(scales)
library(tidyr)
library(viridis)
df_wide = read.csv("../data/expression_od600.csv")
df = gather(df_wide, time, od, X0:X290)
df$time = as.numeric(substring(df$time, 2, 10))
# Remove incorrect measurements
df = df %>% filter(time != 90)
# OD600 measurements
ggplot(df, aes(x = time, y = od, color = rha:iptg)) +
geom_point() +
geom_line() +
ylim(0, 1.6) +
labs(title = "OD600 measurement of E. coli cells under various conditions", x = "Time since inoculation [min]", y = "OD600") +
facet_wrap(vars(medium), nrow = 3) +
theme_minimal()
# OD600 measurements
ggplot(df, aes(x = time, y = od, color = rha:iptg)) +
geom_point() +
geom_line() +
ylim(0, 1.6) +
labs(title = "OD600 measurement of E. coli cells under various conditions", x = "Time since inoculation [min]", y = "OD600") +
facet_wrap(vars(medium), nrow = 3) +
theme_minimal() +
ggsave('../img/absorption_expression.png')
# Fluorescence measurements
ggplot(df, aes(x = Medium, y = Fluorescence.Normalized, fill = Rhamnose:IPTG)) +
geom_col(position = position_dodge()) +
labs(title = "Fluorescence of E. coli cells under various conditions", x = "", y = "Normalized fluorescence") +
theme_minimal() +
ggsave('../img/expression_fluorescence.png')
df = read.csv("../data/expression_fluorescence.csv")
# Fluorescence measurements
ggplot(df, aes(x = Medium, y = Fluorescence.Normalized, fill = Rhamnose:IPTG)) +
geom_col(position = position_dodge()) +
labs(title = "Fluorescence of E. coli cells under various conditions", x = "", y = "Normalized fluorescence") +
theme_minimal() +
ggsave('../img/expression_fluorescence.png')
# Fluorescence measurements
ggplot(df, aes(x = Medium, y = Fluorescence.Normalized, fill = Rhamnose:IPTG)) +
geom_col(position = position_dodge()) +
labs(title = "Fluorescence of E. coli cells after expression with various conditions", x = "", y = "Normalized fluorescence") +
theme_minimal() +
ggsave('../img/expression_fluorescence.png')
df_wide = read.csv("../data/expression_od600.csv")
df = gather(df_wide, time, od, X0:X290)
df$time = as.numeric(substring(df$time, 2, 10))
# Remove incorrect measurements
df = df %>% filter(time != 90)
# OD600 measurements
ggplot(df, aes(x = time, y = od, color = rha:iptg)) +
geom_point() +
geom_line() +
ylim(0, 1.6) +
labs(title = "OD600 measurement of E. coli cells during expression with various conditions", x = "Time since inoculation [min]", y = "OD600") +
facet_wrap(vars(medium), nrow = 3) +
theme_minimal() +
ggsave('../img/absorption_expression.png')
df = read.csv("../data/expression_fluorescence.csv")
# OD600 measurements
ggplot(df, aes(x = time, y = od, color = rha:iptg)) +
geom_point() +
geom_line() +
geom_vline(90, linetype = 'dotted') +
ylim(0, 1.6) +
labs(title = "OD600 measurement of E. coli cells during expression with various conditions", x = "Time since inoculation [min]", y = "OD600") +
facet_wrap(vars(medium), nrow = 3) +
theme_minimal() +
ggsave('../img/absorption_expression.png')
# OD600 measurements
ggplot(df, aes(x = time, y = od, color = rha:iptg)) +
geom_point() +
geom_line() +
geom_vline(xintercept = 90, linetype = 'dotted') +
ylim(0, 1.6) +
labs(title = "OD600 measurement of E. coli cells during expression with various conditions", x = "Time since inoculation [min]", y = "OD600") +
facet_wrap(vars(medium), nrow = 3) +
theme_minimal() +
ggsave('../img/absorption_expression.png')
df_wide = read.csv("../data/expression_od600.csv")
df = gather(df_wide, time, od, X0:X290)
df$time = as.numeric(substring(df$time, 2, 10))
# Remove incorrect measurements
df = df %>% filter(time != 90)
# OD600 measurements
ggplot(df, aes(x = time, y = od, color = rha:iptg)) +
geom_point() +
geom_line() +
geom_vline(xintercept = 90, linetype = 'dotted') +
ylim(0, 1.6) +
labs(title = "OD600 measurement of E. coli cells during expression with various conditions", x = "Time since inoculation [min]", y = "OD600") +
facet_wrap(vars(medium), nrow = 3) +
theme_minimal() +
ggsave('../img/absorption_expression.png')
# OD600 measurements
ggplot(df, aes(x = time, y = od, color = rha:iptg)) +
geom_point() +
geom_line() +
geom_vline(xintercept = 90, linetype = 'dashed') +
ylim(0, 1.6) +
labs(title = "OD600 measurement of E. coli cells during expression with various conditions", x = "Time since inoculation [min]", y = "OD600") +
facet_wrap(vars(medium), nrow = 3) +
theme_minimal() +
ggsave('../img/absorption_expression.png')
# OD600 measurements
ggplot(df, aes(x = time, y = od, color = rha:iptg)) +
geom_point() +
geom_line() +
geom_vline(xintercept = 90, linetype = 'dotted') +
annotate("text", x = 90, y = 1, label = "Addition of IPTG") +
ylim(0, 1.6) +
labs(title = "OD600 measurement of E. coli cells during expression with various conditions", x = "Time since inoculation [min]", y = "OD600") +
facet_wrap(vars(medium), nrow = 3) +
theme_minimal() +
ggsave('../img/absorption_expression.png')
# OD600 measurements
ggplot(df, aes(x = time, y = od, color = rha:iptg)) +
geom_point() +
geom_line() +
geom_vline(xintercept = 90, linetype = 'dotted') +
annotate("text", xmin = 90, y = 1, label = "Addition of IPTG") +
ylim(0, 1.6) +
labs(title = "OD600 measurement of E. coli cells during expression with various conditions", x = "Time since inoculation [min]", y = "OD600") +
facet_wrap(vars(medium), nrow = 3) +
theme_minimal() +
ggsave('../img/absorption_expression.png')
# OD600 measurements
ggplot(df, aes(x = time, y = od, color = rha:iptg)) +
geom_point() +
geom_line() +
geom_vline(xintercept = 90, linetype = 'dotted') +
annotate("text", x = 80, y = 1, label = "Addition of IPTG") +
ylim(0, 1.6) +
labs(title = "OD600 measurement of E. coli cells during expression with various conditions", x = "Time since inoculation [min]", y = "OD600") +
facet_wrap(vars(medium), nrow = 3) +
theme_minimal() +
ggsave('../img/absorption_expression.png')
# OD600 measurements
ggplot(df, aes(x = time, y = od, color = rha:iptg)) +
geom_point() +
geom_line() +
geom_vline(xintercept = 90, linetype = 'dotted') +
annotate("text", x = 60, y = 1, label = "Addition of IPTG") +
ylim(0, 1.6) +
labs(title = "OD600 measurement of E. coli cells during expression with various conditions", x = "Time since inoculation [min]", y = "OD600") +
facet_wrap(vars(medium), nrow = 3) +
theme_minimal() +
ggsave('../img/absorption_expression.png')
# OD600 measurements
ggplot(df, aes(x = time, y = od, color = rha:iptg)) +
geom_point() +
geom_line() +
geom_vline(xintercept = 90, linetype = 'dotted') +
annotate("text", x = 90, y = 1.5, label = "Addition of IPTG") +
ylim(0, 1.6) +
labs(title = "OD600 measurement of E. coli cells during expression with various conditions", x = "Time since inoculation [min]", y = "OD600") +
facet_wrap(vars(medium), nrow = 3) +
theme_minimal() +
ggsave('../img/absorption_expression.png')
df = read.csv("../data/expression_fluorescence.csv")
# Fluorescence measurements
ggplot(df, aes(x = Medium, y = Fluorescence.Normalized, fill = Rhamnose:IPTG)) +
geom_col(position = position_dodge()) +
labs(title = "Fluorescence of E. coli cells after expression with various conditions", x = "", y = "Normalized fluorescence") +
theme_minimal() +
ggsave('../img/expression_fluorescence.png')
View(df)
df = read.csv("../data/bca_assay.csv")
ggplot(df, aes(x = concentration, y = absorption, color = type)) +
geom_point() +
stat_function(fun=function(x)0.81542*x + 0.02701, geom="line", aes(colour="0.81542 * x + 0.02701")) +
labs(title = "OD562 measurement of BCA assay, sample and standard", x = "Concentration [g/l]", y = "OD562") +
theme_minimal()
df
df %>% filter(type == 'sample')
df %>% filter(type == 'standard') %>% summarize(min = min(concentration), max = max(concentration))
min_max_standard_conc = df %>% filter(type == 'standard') %>% summarize(min = min(concentration), max = max(concentration))
df %>% filter(type == 'sample' & between(concentration, min_max_standard_conc$min, min_max_standard_conc$max))
concentration = df %>%
filter(type == 'sample' & between(absorption, min_max_standard_abs$min, min_max_standard_abs$max))
min_max_standard_abs = df %>%
filter(type == 'standard') %>%
summarize(min = min(absorption), max = max(absorption))
concentration = df %>%
filter(type == 'sample' & between(absorption, min_max_standard_abs$min, min_max_standard_abs$max))
concentration
df %>%
filter(type == 'sample' & between(absorption, min_max_standard_abs$min, min_max_standard_abs$max))
concs=c(0.628*40,1.030*20)
mean(concs)
mean(c(0.628, 1.030))
mean(c(0.628, 1.030))*40
mean(c(0.628, 1.030))*20
mean(c(0.628, 1.030))*30
concs
concs
mean(concs)
sd(concs)
df
concs
df
concs
0.628*40
mean(concs)
sd(concs)
extinction_factor = 46.36
dilution_factor = 750 / 2
df_wide = read.csv("../data/raw/hs_concentration.csv")
df_full = gather(df_wide, series, absorption, hs_wt_ox:hs_dsred_red)
df_full$protein[grepl('_wt_', df_full$series, fixed=TRUE)] = 'wildtype'
df_full$protein[grepl('_mut_', df_full$series, fixed=TRUE)] = 'mutant'
df_full$protein[grepl('_dsred_', df_full$series, fixed=TRUE)] = 'dsred'
df_full$state[grepl('_ox', df_full$series, fixed=TRUE)] = 'oxidated'
# Careful not to match '_dsred', hence the EOL matcher
df_full$state[grepl('_red$', df_full$series)] = 'reduced'
df_full$state = factor(df_full$state)
df_full$protein = factor(df_full$protein)
baseline_correction = df_full %>%
filter(between(wavelength, 580, 600)) %>%
group_by(protein, state) %>%
summarize(n(), mean_absorption = mean(absorption)) %>%
group_by(protein) %>%
summarize(baseline_correction = round(max(mean_absorption) - min(mean_absorption), 3))
baseline_correction
concentrations = df_full %>%
filter(between(wavelength, 561, 561.1)) %>%
group_by(protein) %>%
summarize(absorption_delta = round(max(absorption) - min(absorption), 3)) %>%
left_join(baseline_correction, by="protein") %>%
mutate(absorption_delta_corrected = round(absorption_delta + baseline_correction, 3)) %>%
mutate(concentration = round(absorption_delta_corrected / extinction_factor * dilution_factor, 3))
concentrations
write.csv(concentrations, '../data/hs_concentration.csv', row.names = FALSE, quote=FALSE)
ggplot(df_full, aes(x = wavelength, y = absorption, color = state)) +
geom_point(size = 0.1) +
geom_line() +
facet_wrap(vars(protein), ncol = 1) +
labs(title = "HS concentration determination", x = "Wavelength [nm]", y = "Absorption") +
theme_minimal() +
ggsave('../img/hs_concentration.png', width = 20, units = 'cm', dpi = 'print')
concentrations = df_full %>%
filter(between(wavelength, 561, 561.1)) %>%
group_by(protein) %>%
summarize(absorption_delta = round(max(absorption) - min(absorption), 3)) %>%
left_join(baseline_correction, by="protein") %>%
mutate(absorption_delta_corrected = round(absorption_delta + baseline_correction, 3)) %>%
mutate(concentration = round(absorption_delta_corrected / extinction_factor * dilution_factor, 3))
write.csv(concentrations, '../data/hs_concentration.csv', row.names = FALSE, quote=FALSE)
ggplot(df_full, aes(x = wavelength, y = absorption, color = state)) +
geom_point(size = 0.1) +
geom_line() +
facet_wrap(vars(protein), ncol = 1) +
labs(title = "HS concentration determination", x = "Wavelength [nm]", y = "Absorption") +
theme_minimal() +
ggsave('../img/hs_concentration.png', width = 20, units = 'cm', dpi = 'print')
concentrations
